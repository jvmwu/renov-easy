# RenovEasy Development Environment Configuration
# This file contains all configuration for local development
# NEVER commit this file to version control

# ============================================
# Environment
# ============================================
ENVIRONMENT=development

# ============================================
# Server Configuration
# ============================================
SERVER_HOST=127.0.0.1
SERVER_PORT=8080
# Maximum request body size in bytes (10MB)
MAX_BODY_SIZE=10485760
# Request timeout in seconds
REQUEST_TIMEOUT=30

# ============================================
# Database Configuration
# ============================================
# MySQL connection URL
DATABASE_URL=mysql://renoveasy:renoveasy_dev_2025@localhost:3306/renoveasy_dev

# Database pool configuration
DB_MAX_CONNECTIONS=10
DB_MIN_CONNECTIONS=2
DB_CONNECTION_TIMEOUT=10
DB_IDLE_TIMEOUT=300
DB_MAX_LIFETIME=1800

# ============================================
# Redis Configuration
# ============================================
# Redis connection URL
REDIS_URL=redis://localhost:6379/0

# Redis pool configuration
REDIS_MAX_CONNECTIONS=10
REDIS_MIN_CONNECTIONS=2
REDIS_CONNECTION_TIMEOUT=5

# ============================================
# JWT Configuration
# ============================================
# JWT secret key (use a strong random string in production)
JWT_SECRET=dev_secret_key_please_change_in_production_minimum_32_chars_long

# Token expiry times (in seconds)
JWT_ACCESS_TOKEN_EXPIRY=900        # 15 minutes
JWT_REFRESH_TOKEN_EXPIRY=604800    # 7 days

# JWT algorithm (RS256 recommended for production)
JWT_ALGORITHM=HS256

# ============================================
# SMS Service Configuration
# ============================================
# SMS provider (mock, twilio, aws_sns)
SMS_PROVIDER=mock

# Twilio configuration (when SMS_PROVIDER=twilio)
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_FROM_NUMBER=+1234567890

# AWS SNS configuration (when SMS_PROVIDER=aws_sns)
AWS_ACCESS_KEY_ID=your_aws_access_key
AWS_SECRET_ACCESS_KEY=your_aws_secret_key
AWS_REGION=ap-southeast-2

# SMS templates
SMS_VERIFICATION_TEMPLATE="[RenovEasy] Your verification code is: {code}. Valid for 5 minutes."
SMS_VERIFICATION_TEMPLATE_ZH="[装修易] 您的验证码是：{code}。有效期5分钟。"

# ============================================
# Rate Limiting Configuration
# ============================================
# Enable rate limiting
RATE_LIMIT_ENABLED=true

# SMS rate limits (per phone per hour)
SMS_RATE_LIMIT_MAX_ATTEMPTS=3
SMS_RATE_LIMIT_WINDOW_SECONDS=3600

# API rate limits (per IP per minute)
API_RATE_LIMIT_MAX_REQUESTS=60
API_RATE_LIMIT_WINDOW_SECONDS=60

# Auth rate limits
AUTH_MAX_LOGIN_ATTEMPTS=5
AUTH_LOCKOUT_DURATION_SECONDS=1800  # 30 minutes

# ============================================
# CORS Configuration
# ============================================
# Allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8080

# Allowed methods
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS

# Allowed headers
CORS_ALLOWED_HEADERS=Content-Type,Authorization,Accept,X-Request-ID

# Allow credentials
CORS_ALLOW_CREDENTIALS=true

# Max age for preflight cache (in seconds)
CORS_MAX_AGE=3600

# ============================================
# Logging Configuration
# ============================================
# Log level (trace, debug, info, warn, error)
LOG_LEVEL=debug

# Log format (json, pretty)
LOG_FORMAT=pretty

# Enable request logging
LOG_REQUESTS=true

# Enable SQL query logging
LOG_SQL_QUERIES=true

# ============================================
# Security Configuration
# ============================================
# Enable HTTPS enforcement (should be false for local development)
ENFORCE_HTTPS=false

# Security headers
SECURITY_HEADERS_ENABLED=true

# Content Security Policy
CSP_ENABLED=false

# ============================================
# Feature Flags
# ============================================
# Enable user registration
FEATURE_USER_REGISTRATION=true

# Enable SMS verification (set to false to skip SMS in development)
FEATURE_SMS_VERIFICATION=true

# Enable rate limiting
FEATURE_RATE_LIMITING=true

# Enable audit logging
FEATURE_AUDIT_LOGGING=true

# ============================================
# External Services
# ============================================
# Google Maps API (for future use)
GOOGLE_MAPS_API_KEY=your_google_maps_api_key

# ============================================
# Testing Configuration
# ============================================
# Test database (used when running tests)
TEST_DATABASE_URL=mysql://renoveasy:renoveasy_test_2025@localhost:3306/renoveasy_test

# Test Redis database
TEST_REDIS_URL=redis://localhost:6379/1

# ============================================
# Development Tools
# ============================================
# Enable Swagger UI
SWAGGER_ENABLED=true
SWAGGER_PATH=/api/docs

# Enable GraphQL playground (future)
GRAPHQL_PLAYGROUND_ENABLED=false

# Enable debug endpoints
DEBUG_ENDPOINTS_ENABLED=true

# ============================================
# Monitoring (Optional)
# ============================================
# Sentry DSN (for error tracking)
SENTRY_DSN=

# OpenTelemetry endpoint
OTEL_EXPORTER_OTLP_ENDPOINT=

# Metrics collection
METRICS_ENABLED=false
METRICS_PORT=9090

# ============================================
# Notes for Developers
# ============================================
# 1. Copy this file to .env to use it
# 2. Adjust values according to your local setup
# 3. Never commit .env files to version control
# 4. For production, use environment-specific configuration
# 5. Ensure MySQL and Redis are running before starting the server
#
# Quick setup commands:
# - Start MySQL: docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=root -e MYSQL_DATABASE=renoveasy_dev -e MYSQL_USER=renoveasy -e MYSQL_PASSWORD=renoveasy_dev_2025 mysql:8
# - Start Redis: docker run -d -p 6379:6379 redis:7-alpine
# - Run migrations: sqlx migrate run
# - Start server: cargo run --bin api